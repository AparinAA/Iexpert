{% extends "base_generic.html" %}

{% block content %}
<h1 class="drop-shadow p-2 mb-4 mt-0 ml-0 rounded d-flex"><small>Подтверждение оценок</small></h1>
<div class="drop-shadow p-2 mb-4 mt-0 ml-0 rounded">
    <h4> <p> Эксперт: {{checkexpertscore.expert}}</p> </h4>
    {% if checkexpertscore.count_all == 0 %}
        <p class="ml-4"> У данного эксперта нет назначенных заявок </p>
    {% else %}
        {% for item in checkexpertscore.get_all_score %}
        <div class="list-unstyled hoverDiv">
            <div class="m-auto">
                <b> {{ item.relation_exp_app.application }} </b>
                {% if not checkexpertscore.check_exp %}
                    - <a href="{% url 'score_expert_form' item.pk %}" class="btn btn-secondary btn-sm"> Изменить оценки </a>
                {% endif %}
            </div>
            <br/>

            <table class="table table-sm table-responsive-lg">
                <thead class="bg-light">
                <tr>
                    <td scope="col" class="text-center"><i> Оценка по критерию №1 </i></td>
                    <td scope="col" class="text-center"><i> Оценка по критерию №2</i></td>
                    <td scope="col" class="text-center"><i> Оценка по критерию №3 </i></td>
                    <td scope="col" class="text-center"><i> Оценка по критерию №4 </i></td>
                    <td scope="col" class="text-center"><i> Оценка по критерию №5 </i></td>
                </tr>
                </thead>
                <tbody>
                <tr>
                    {% if item.score1 is None %} 
                        <td class="table-danger text-danger text-center"> 
                            <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/><path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/></svg>
                        </td>
                    {% else %} 
                        <td class="table-success text-center"> <b>{{ item.score1 }}</b></td> 
                    {% endif %}
                    {% if item.score2 is None %} 
                        <td class="table-danger text-danger text-center">
                            <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/><path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/></svg> 
                        </td>
                    {% else %} 
                        <td class="table-success text-center"> <b>{{ item.score2 }}</b></td> 
                    {% endif %}
                    {% if item.score3 is None %} 
                        <td class="table-danger text-danger text-center">
                            <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/><path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/></svg> 
                        </td>
                    {% else %} 
                        <td class="table-success text-center"> <b>{{ item.score3 }}</b></td> 
                    {% endif %}
                    {% if item.score4 is None %} 
                        <td class="table-danger text-danger text-center">
                            <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/><path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/></svg>
                        </td>
                    {% else %} 
                        <td class="table-success text-center"> <b>{{ item.score4 }}</b></td> 
                    {% endif %}
                    {% if item.score5 is None %} 
                        <td class="table-danger text-danger text-center">
                            <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/><path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/></svg>
                        </td>
                    {% else %} 
                        <td class="table-success text-center"> <b>{{ item.score5 }}</b></td> 
                    {% endif %}
                </tr>
                </tbody>
            </table>
            {% if item.comment is None or item.comment == "" %}
                <li><i>Комментарий: </i> <span class="text-danger">  Вы не оставили комментарий по заявке </span> </li>
            {% else %}
                <li style="overflow-wrap: break-word"><i>Комментарий: </i> {{ item.comment }}</li>
            {% endif %}

        </div>
        <hr/>
        <br/>
        {% endfor %}

        {% for item in checkexpertscore.get_all_score_common %}
        <div class="list-unstyled ml-2 hoverDiv">
            <div class="m-auto">
                <b> {{ item.relation_exp_app.application }} </b>
                {% if not checkexpertscore.check_exp %}
                    - <a href="{% url 'score_common_form' item.pk %}" class="btn btn-secondary btn-sm "> Изменить оценки </a>
                {% endif %}
            </div>
            <br/>
            <div class="row ml-1">
                <div class="col-md-2 font-italic bg-light text-center"> Оценка: </div> 
                {% if item.score is None %} 
                    <div class="table-danger col-md-2 text-center ">
                        <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/><path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/></svg>
                    </div>  
                {% else %}
                    <div class="table-success col-md-2 text-center "><b>{{ item.score }}</b></div>
                {% endif %}
            </div>
            <div class="row ml-1 mr-1">
                <div class="col-md-2 font-italic bg-light text-center ">
                Комментарий:
                </div> 
                {% if item.comment is None or item.comment == "" %}
                    <div class="table-danger col-md-2 text-center">
                        <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/><path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/></svg>
                    </div>
                {% else %}
                    <div class="col-md-10 text-left">
                        <span style="overflow-wrap: break-word">{{ item.comment }}</span>
                    </div> 
                {% endif %}
            </div>
        </div>
        <hr/>
        {% endfor %}

        {% load crispy_forms_tags %}

        {% if not checkexpertscore.check_exp %}
            {% if checkexpertscore.count_all == checkexpertscore.count_ok %}
            <form action="" method="post" class="ml-1">
                {% csrf_token %} {# {{ form.as_table }} class="fieldWrapper"#}
                   <b style='color: #000000; font-size: 15px'> Подтвердите свои оценки:</b>
                     {{ form.check_exp.help_text }}
                    {{ form.check_exp.errors }}
                     {{ form.check_exp }}
                <br/>
                <br/>


                <i> Просьба перед отправкой подтверждения убедиться, что оценки по заявкам указаны корректно. Вы не сможете самостоятельно изменить выбранные оценки после их подтверждения</i>
                <br/>        <br/>

                <input type="submit" value="Отправить" class="btn btn-secondary">
            </form>
                {%else%}
        <b> Вы не завершили экспертную оценку заявок. Пожалуйста, вернитесь к <a href="{% url 'index' %}" class="text-info"> нерассмотренным заявкам</a>, выставите оценки и вернитесь на эту страницу после </b>
            {%endif%}
        {%else%}
        <div class="ml-2">
        <p><b>Вы завершили экспертную оценку заявок.</p>
        Если вы хотите внести изменения, то напишите на почту <a href="mailto:support@iproficlub.ru" class="text-info"> support@iproficlub.ru </a></b>
        </div>
        {%endif%}
    {% endif %}
</div>
{% endblock %}